<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Rotate Image to Mouse</title>
    <style>
      body { 
        margin: 0;
        background: url("ga.png") no-repeat center center fixed; /* imagen de fondo */
        background-size: cover; /* que cubra toda la ventana el fondo */
        color: #fff; 
        font-family: sans-serif; 
        text-align: center; 
      }
      canvas {
        border: 1px solid #444;
        background: rgba(34,34,34,0.85); /* un poco translucido para ver el fondo detras */
        display: block;
        margin: 1rem auto;
      }
      button {
        margin-top: 10px;
        padding: 8px 12px;
        border-radius: 6px;
        border: none;
        background: #444;
        color: #fff;
        cursor: pointer;
      }
      button:hover { background: #666; }
    </style>
  </head>
  <body>
    <h2>Move that Gallagher</h2>
    <canvas id="canvas" width="500" height="500"></canvas>
    <aside>Move the mouse over the canvas</aside>

    <!-- Botones -->
    <button id="resetBtn" type="button">Reset that Gallagher boy (R)</button>
    <button id="musicBtn" type="button">Pause Music</button>

    <!-- Música de fondo -->
     
    <audio id="bgMusic" src="TruE.mp3" loop></audio>
    

    <script>
      const canvas = document.getElementById("canvas");
      const ctx = canvas.getContext("2d");

      // Cargar la imagen que va a rotar
      const img = new Image();
      img.src = "gallagher.png"; // imagen del personaje

      // Objeto que rota
      const sprite = {
        x: canvas.width / 2,
        y: canvas.height / 2,
        rotation: 0
      };

      // Puntero
      const mouse = { x: canvas.width/2, y: canvas.height/2 };
      canvas.addEventListener("mousemove", e => {
        const rect = canvas.getBoundingClientRect();
        mouse.x = e.clientX - rect.left;
        mouse.y = e.clientY - rect.top;
      });

      //  Función para resetear posición
      function resetPosition() {
        sprite.x = canvas.width / 2;
        sprite.y = canvas.height / 2;
        mouse.x = sprite.x;
        mouse.y = sprite.y;
      }

      document.getElementById("resetBtn").addEventListener("click", resetPosition);
      window.addEventListener("keydown", (e) => {
        if (e.key === 'r' || e.key === 'R') resetPosition();
      });

      //  Control de musica Play/Pause
      const music = document.getElementById("bgMusic");
      const musicBtn = document.getElementById("musicBtn");
      music.volume = 0.2;


      musicBtn.addEventListener("click", () => {
        if (music.paused) {
          music.play();
          musicBtn.textContent = "Pause Music";
        } else {
          music.pause();
          musicBtn.textContent = "Play Music";
        }
      });

      // Iniciar musica al cargar (solo si el navegador lo permite)
      music.play().catch(() => { 
        musicBtn.textContent = "Play Music"; 
      });

      function loop() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        const dx = mouse.x - sprite.x;
        const dy = mouse.y - sprite.y;
        sprite.rotation = Math.atan2(dy, dx);

        if (img.complete) {
          ctx.save();
          ctx.translate(sprite.x, sprite.y);
          ctx.rotate(sprite.rotation);
          ctx.drawImage(img, -img.width/2, -img.height/2);
          ctx.restore();
        }

        requestAnimationFrame(loop);
      }

      img.onload = loop;
    </script>
  </body>
</html>
